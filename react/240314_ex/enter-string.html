<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script crossorigin src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <title>Enter String</title>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const { useState, useEffect } = React;

    // 문자열을 입력해주세요.

    // 입력한 문자열을 input에 입력하는 타자속도가 얼마나 걸리는지 alert로 표시

    // getTime
    // enter키로 인식되도록  

    function Timer(){

      useEffect(
        () => {console.log('타이머가 시작합니다...');

          const timerStart = new Date().getTime();
          console.log('timerStart : '+timerStart);

          return () => {            
            const timerEnd = new Date().getTime();
            console.log('timerEnd : '+timerEnd);

            console.log('time took : '+((timerEnd - timerStart) / 1000))

            //const takenTime = timerStart - timerEnd
            //clearInterval(timer);
            console.log('타이머가 종료됩니다...');
          }
        },
        []
      );

    }
    
    function App(){

      const [isEntered, setIsEntered] = useState(false);
      const [promptText, setPromptText] = useState('');
      const [typeString, setTypeString] = useState('');
      const [pressEnter, setPressEnter] = useState(false);
      const [isTyped, setIsTyped] = useState(false);            

      useEffect(
        () => {        
          console.log('isEntered'+isEntered);
          if (isEntered == false) {
            const answer = prompt("문자열을 입력해주세요.");
            console.log('Text entered in prompt :' + answer);
            setPromptText(answer);
            console.log('promptText :' + promptText);
          }
          // if (didPromptRef.current === false) {
          //   didLogRef.current = true;
          //   const pName = prompt("Insert name");
          //   setPlayerName(pName);
          // }
        }, []
      );

      const onChangeHander = (e) => {
          console.log('now typing in input'); 
          console.log('isTyped : '+isTyped); 
          setIsTyped(true); 
          console.log('after isTyped : '+isTyped);
          console.log()
      }

      
      // 타자 입력 시작 시 타이머 시작
      

      useEffect(
        () => {
          console.log('isTyped : '+isTyped);
          if (isTyped == true) {
            console.log('타이머가 시작합니다...');

            const timerStart = new Date().getTime();
            console.log('timerStart : '+timerStart);  
            
            if(pressEnter == true){ //enter key 누른 상태              
              const timerEnd = new Date().getTime();
                console.log('timerEnd : '+timerEnd);

                console.log('time took : '+((timerEnd - timerStart) / 1000))
                
                //alert(((timerEnd - timerStart) / 1000) + '초 걸렸습니다.');
                //const takenTime = timerStart - timerEnd
                //clearInterval(timer);
              return () => {                                          
                console.log('타이머가 종료됩니다...');
              }
            }
          }
        }
      )

      // enter 키 누르기
      const handleKeyPress = (e) => {
        if(e.key === 'Enter') {
          console.log('enter키를 클릭했습니다.');
          // e.target.value == answer ? console.log('You typed right!') : console.log('You typed wrong!');
          setPressEnter(true);          
        }
      }

      //(answer == undefined || answer == '' || answer == ' ') ? alert('문자열을 입력하지 않았습니다.')

      return (

        <> 
          <h2>{promptText}</h2>
          <input type="text" name="typeString" onKeyPress={handleKeyPress} onChange={onChangeHander}/>
        </>
      );
    }

    ReactDOM.createRoot(document.getElementById('root')).render(<App/>)
  </script>
</body>
</html>
